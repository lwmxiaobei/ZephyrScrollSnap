# Chrome 长图截取插件

一个功能强大的Chrome浏览器扩展，支持在网页上通过鼠标拖动选择截图区域，支持滚动页面进行长图截取，提供丰富的标注工具，并将截图下载到本地。

## ✨ 功能特性

- 🖱️ **鼠标拖动选择** - 直观的区域选择体验
- 📏 **实时尺寸显示** - 选择时显示区域尺寸
- 📜 **长图截取** - 自动滚动拼接长页面截图
- 💾 **一键下载** - 自动保存为PNG格式
- ✏️ **画笔涂鸦** - 自由绘制，支持颜色和粗细调节
- ▦ **马赛克工具** - 框选区域快速打码，保护隐私
- □ **矩形标注** - 绘制矩形框，突出重点区域
- → **箭头标注** - 绘制箭头，精准指示目标
- ↩️ **撤销功能** - 支持 Ctrl/Cmd+Z 快速撤销
- ⌨️ **快捷键支持** - ESC键快速取消
- 🎨 **现代UI设计** - 简洁美观的用户界面

## 📦 安装方法

1. 下载或克隆此项目到本地
2. 打开Chrome浏览器，访问 `chrome://extensions/`
3. 打开右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目文件夹

## 🚀 使用方法

1. **启动截图**
   - 点击浏览器工具栏中的扩展图标
   - 点击"开始截图"按钮

2. **选择区域**
   - 在页面上按住鼠标左键并拖动
   - 释放鼠标完成选择
   - 实时显示选择区域的尺寸

3. **确认或取消**
   - 点击"✓ 确认截图"按钮开始截图
   - 点击"✕ 取消"按钮或按ESC键取消

4. **标注工具**
   - **马赛克** ▦：框选区域添加马赛克效果，保护隐私信息
   - **画笔** ✏：自由绘制，可调节颜色和粗细
   - **矩形** □：绘制矩形框，突出显示重要区域
   - **箭头** →：绘制箭头，精准指示目标位置
   - **撤销** ↩：撤销上一步操作（也可使用 Ctrl/Cmd+Z）

5. **保存截图**
   - 完成标注后点击"✓ 确认截图"即可下载PNG格式图片

## 📂 项目结构

```
jietu/
├── manifest.json       # 扩展配置文件
├── popup.html          # 弹出窗口UI
├── popup.js            # 弹出窗口逻辑
├── content.js          # 内容脚本（区域选择 + 图片处理）
├── background.js       # 后台服务（截图协调）
├── styles.css          # 样式文件
├── icons/              # 扩展图标
│   ├── icon16.png
│   ├── icon48.png
│   └── icon128.png
└── README.md           # 项目说明
```

## 🔧 技术实现

### 核心功能

1. **区域选择** (`content.js`)
   - 在页面上覆盖透明层
   - 监听鼠标事件实现拖动选择
   - 动态显示选择框和尺寸信息
   - Canvas图片处理（裁剪、拼接）
   - 触发浏览器下载

2. **标注工具** (`content.js`)
   - **马赛克**：框选区域应用马赛克效果
   - **画笔**：自由绑定绘制，支持颜色和粗细设置
   - **矩形**：拖拽绘制矩形边框，实时预览
   - **箭头**：拖拽绘制箭头，支持颜色和粗细设置
   - 各工具独立画布，支持多层叠加
   - 统一撤销机制，支持历史记录

2. **截图协调** (`background.js`)
   - 接收截图请求
   - 判断单视口 vs 长图模式
   - 使用 `chrome.tabs.captureVisibleTab()` 捕获屏幕
   - 协调页面滚动和多次截图
   - 将数据发送回content script处理

3. **用户界面** (`popup.html/js`)
   - 提供启动入口
   - URL验证（检测特殊页面）
   - 错误提示

### 使用的Chrome API

- `chrome.tabs` - 标签页操作
- `chrome.scripting` - 脚本注入
- `chrome.downloads` - 文件下载
- `chrome.runtime` - 消息通信

## ⚠️ 注意事项

> [!IMPORTANT]
> **不支持在以下特殊页面上截图**：
> - `chrome://` 开头的Chrome内部页面（如 chrome://extensions/）
> - `chrome-extension://` 扩展页面
> - `edge://` Edge浏览器内部页面
> - `about:` 系统页面
>
> 请在普通网页（如 https://www.google.com）上使用此扩展。

- 扩展需要"activeTab"、"scripting"和"downloads"权限
- 长图截取时页面会自动滚动，请勿操作页面
- 截图文件默认保存为PNG格式

## 🎯 适用场景

- 📰 长文章截图
- 🛒 电商页面完整截图
- 📊 数据报表截图
- 💬 聊天记录截图
- 📱 网页设计稿截图

## 🔄 更新日志

### v1.1.0 (2025-12-02)
- ✨ 新增矩形标注工具
- ✨ 新增箭头标注工具
- ✨ 新增马赛克打码功能
- ✨ 画笔/矩形/箭头支持颜色和粗细调节
- ✨ 新增统一撤销功能（支持 Ctrl/Cmd+Z）
- 🎨 工具栏 UI 优化
- 🐛 修复多画布叠加问题

### v1.0.0 (2025-12-01)
- ✨ 初始版本发布
- ✅ 支持区域选择
- ✅ 支持长图截取
- ✅ 支持一键下载
- ✅ 支持画笔涂鸦

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交Issue和Pull Request！

---

**Enjoy capturing beautiful screenshots! 📸**
